(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[303],{7772:function(e,t,s){Promise.resolve().then(s.bind(s,5702))},5702:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var l=s(7437),a=s(4005),r=s(2265),n=s(495),i=s(7440),c=s(6013),o=s(1254),d=s(8969),u=s(3705),h=s(510),x=s(8884);async function f(e){let t=(0,u.JU)(d.db,"rating",e),s=await (0,u.QT)(t);if(!s.exists())return console.log("No such document!"),{chessRating:"400",attempts:0,puzzleID:1,noOfCorrect:0,lastestDate:new Date().toLocaleDateString(),threePuzzleCorrect:!1};{let e=s.data();return{chessRating:e.chessRating,attempts:e.attempts,puzzleID:e.puzzleID,noOfCorrect:e.noOfCorrect,latestDate:e.latestDate,threePuzzleCorrect:e.threePuzzleCorrect}}}function m(){let{user:e,addXp:t}=(0,h.a)(),[s,m]=(0,r.useState)("600"),[z,p]=(0,r.useState)(0),[j,g]=(0,r.useState)(1),[N,v]=(0,r.useState)(0),[w,y]=(0,r.useState)([]),[C,b]=(0,r.useState)(o[s][j]),[D,R]=(0,r.useState)(!1),S=new Date().toLocaleDateString();(0,r.useEffect)(()=>{e&&f(e.uid).then(e=>{console.log("Fetched badge data:",e),m(e.chessRating),p(e.attempts),R(e.threePuzzleCorrect),g(e.puzzleID),v(e.noOfCorrect),b(o[e.chessRating][e.puzzleID-1]),k(e.latestDate),console.log("user is changed")}).catch(e=>console.error("Error fetching user badge:",e))},[e]);let O=async()=>{let t=z-1;if(p(t),e){let s=(0,u.JU)(d.db,"rating",e.uid);await (0,u.r7)(s,{attempts:t})}},k=async t=>{if(t!=S&&(p(3),e)){let t=(0,u.JU)(d.db,"rating",e.uid);await (0,u.r7)(t,{attempts:3,threePuzzleCorrect:!1,latestDate:S})}},E=async()=>{let l=s,a=j+1,r=N+1,n=D;if(t(20),r>=3&&(1100>Number(s)&&["400","500","600","700","800","900","1000","1100"].includes(l=String(Number(s)+100))&&(m(l),a=1),n=!0,R(!0),r=0),v(r),g(a),e){let t=(0,u.JU)(d.db,"rating",e.uid);await (0,u.r7)(t,{puzzleID:a,noOfCorrect:r,chessRating:l,threePuzzleCorrect:n}),console.log("doc is updated")}};(0,r.useEffect)(()=>{let e=o[s];y(e),b(e[j-1]),console.log("rating is changed")},[s]);let F=w[j+1-1];return 2==N&&"1100"!=s&&(F=o[String(Number(s)+100)][0]),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(x.ChessSidebar,{highlightedLink:"quiz"}),D?(0,l.jsx)("div",{className:"flex h-screen w-full items-center justify-center text-4xl",children:(0,l.jsx)("h1",{className:"py-20",children:"Congratulations! You have completed the daily quiz."})}):0==z?(0,l.jsx)("div",{className:"flex h-screen w-full items-center justify-center text-4xl",children:(0,l.jsx)("h1",{className:"py-20",children:"You have no attempts left. Come back again tomorrow."})}):(0,l.jsx)(a.L.Root,{puzzle:{fen:C.FEN,moves:C.Moves,makeFirstMove:!0},children:(0,l.jsxs)("div",{className:"flex h-screen w-full flex-row overflow-hidden p-10",children:[(0,l.jsx)("div",{className:"w-1/2",children:(0,l.jsx)(a.L.Board,{})}),(0,l.jsx)("div",{className:"flex h-1/2 w-full justify-center p-4 sm:w-2/5 sm:p-10",children:(0,l.jsxs)(c.Zb,{className:"w-full",children:[(0,l.jsx)(c.Ol,{children:(0,l.jsxs)(c.ll,{className:"flex justify-center text-4xl",children:["Daily Quiz #",j," ",s," Rating"]})}),(0,l.jsx)(c.aY,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-center",children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(a.L.Reset,{asChild:!0,puzzle:{fen:C.FEN,moves:C.Moves,makeFirstMove:!0},showOn:["in-progress"],children:(0,l.jsx)(n.z,{className:(0,i.cn)((0,n.d)({size:"xl"}),"px-8 py-4 text-xl"),children:"Restart"})})}),(0,l.jsx)("div",{className:"px-4",children:(0,l.jsx)(a.L.Reset,{asChild:!0,puzzle:{fen:C.FEN,moves:C.Moves,makeFirstMove:!0},onReset:()=>{O()},showOn:["failed"],children:(0,l.jsx)(n.z,{className:(0,i.cn)((0,n.d)({size:"xl"}),"px-8 py-4 text-xl"),children:"Try Again"})})}),(0,l.jsx)("div",{className:"",children:(0,l.jsx)(a.L.Reset,{asChild:!0,onReset:()=>{b(F),E()},puzzle:{fen:F.FEN,moves:F.Moves,makeFirstMove:!0},showOn:["solved"],children:(0,l.jsx)(n.z,{className:(0,i.cn)((0,n.d)({size:"xl"}),"px-8 py-4 text-xl"),children:"Next"})})})]})}),(0,l.jsxs)(c.eW,{className:"flex justify-center",children:["You have ",z," attempts left",(0,l.jsx)("br",{})]}),(0,l.jsx)(c.eW,{className:"flex justify-center",children:"If the first move is not played, please refresh the page"})]})})]})})]})}}},function(e){e.O(0,[106,37,364,866,149,810,103,173,942,5,154,695,410,971,23,744],function(){return e(e.s=7772)}),_N_E=e.O()}]);