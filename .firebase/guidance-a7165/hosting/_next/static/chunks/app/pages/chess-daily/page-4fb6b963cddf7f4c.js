(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[303],{7772:function(e,s,t){Promise.resolve().then(t.bind(t,5702))},5702:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var l=t(7437),a=t(4005),n=t(2265),i=t(495),c=t(7440),r=t(6013),o=t(1254),d=t(8969),u=t(3705),h=t(510),x=t(8884);async function f(e){let s=(0,u.JU)(d.db,"rating",e),t=await (0,u.QT)(s);if(!t.exists())return console.log("No such document!"),{chessRating:"400",attempts:0,puzzleID:1,noOfCorrect:0,lastestDate:new Date().toLocaleDateString()};{let e=t.data();return{chessRating:e.chessRating,attempts:e.attempts,puzzleID:e.puzzleID,noOfCorrect:e.noOfCorrect,latestDate:e.latestDate}}}function m(){let{user:e,addXp:s}=(0,h.a)(),[t,m]=(0,n.useState)("600"),[p,g]=(0,n.useState)(0),[j,N]=(0,n.useState)(1),[v,z]=(0,n.useState)(0),[w,y]=(0,n.useState)([]),[D,b]=(0,n.useState)(o[t][j]),[R,C]=(0,n.useState)(!1),S=new Date().toLocaleDateString();(0,n.useEffect)(()=>{e&&f(e.uid).then(e=>{console.log("Fetched badge data:",e),m(e.chessRating),g(e.attempts),N(e.puzzleID),z(e.noOfCorrect),b(o[e.chessRating][e.puzzleID-1]),console.log(e.latestDate),console.log(S),k(e.latestDate),console.log("user is changed")}).catch(e=>console.error("Error fetching user badge:",e))},[e]);let O=async()=>{let s=p-1;if(g(s),e){let t=(0,u.JU)(d.db,"rating",e.uid);await (0,u.r7)(t,{attempts:s})}},k=async s=>{if(s!=S&&(g(3),e)){let s=(0,u.JU)(d.db,"rating",e.uid);await (0,u.r7)(s,{attempts:3,latestDate:S})}},E=async()=>{let l=t,a=j+1,n=v+1;if(s(20),n>=3&&(1100>Number(t)&&["400","500","600","700","800","900","1000","1100"].includes(l=String(Number(t)+100))&&(m(l),a=1),C(!0),n=0),z(n),N(a),e){let s=(0,u.JU)(d.db,"rating",e.uid);await (0,u.r7)(s,{puzzleID:a,noOfCorrect:n,chessRating:l}),console.log("doc is updated")}};(0,n.useEffect)(()=>{let e=o[t];y(e),b(e[j-1]),console.log("rating is changed")},[t]);let F=w[j+1-1];return 2==v&&"1100"!=t&&(F=o[String(Number(t)+100)][0]),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(x.ChessSidebar,{highlightedLink:"quiz"}),R?(0,l.jsx)("div",{className:"flex h-screen w-full items-center justify-center text-4xl",children:(0,l.jsx)("h1",{className:"py-20",children:"Congratulations! You have completed the daily quiz."})}):0==p?(0,l.jsx)("div",{className:"flex h-screen w-full items-center justify-center text-4xl",children:(0,l.jsx)("h1",{className:"py-20",children:"You have no attempts left. Come back again tomorrow."})}):(0,l.jsx)(a.L.Root,{puzzle:{fen:D.FEN,moves:D.Moves,makeFirstMove:!0},children:(0,l.jsxs)("div",{className:"flex h-screen w-full flex-row overflow-hidden p-10",children:[(0,l.jsx)("div",{className:"w-1/2",children:(0,l.jsx)(a.L.Board,{})}),(0,l.jsx)("div",{className:"flex h-1/2 w-full justify-center p-4 sm:w-2/5 sm:p-10",children:(0,l.jsxs)(r.Zb,{className:"w-full",children:[(0,l.jsx)(r.Ol,{children:(0,l.jsxs)(r.ll,{className:"flex justify-center text-4xl",children:["Daily Quiz #",j," ",t," Rating"]})}),(0,l.jsx)(r.aY,{children:(0,l.jsxs)("div",{className:"flex flex-row justify-center",children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(a.L.Reset,{asChild:!0,puzzle:{fen:D.FEN,moves:D.Moves,makeFirstMove:!0},showOn:["in-progress"],children:(0,l.jsx)(i.z,{className:(0,c.cn)((0,i.d)({size:"xl"}),"px-8 py-4 text-xl"),children:"Restart"})})}),(0,l.jsx)("div",{className:"px-4",children:(0,l.jsx)(a.L.Reset,{asChild:!0,puzzle:{fen:D.FEN,moves:D.Moves,makeFirstMove:!0},onReset:()=>{O()},showOn:["failed"],children:(0,l.jsx)(i.z,{className:(0,c.cn)((0,i.d)({size:"xl"}),"px-8 py-4 text-xl"),children:"Try Again"})})}),(0,l.jsx)("div",{className:"",children:(0,l.jsx)(a.L.Reset,{asChild:!0,onReset:()=>{b(F),E()},puzzle:{fen:F.FEN,moves:F.Moves,makeFirstMove:!0},showOn:["solved"],children:(0,l.jsx)(i.z,{className:(0,c.cn)((0,i.d)({size:"xl"}),"px-8 py-4 text-xl"),children:"Next"})})})]})}),(0,l.jsxs)(r.eW,{className:"flex justify-center",children:["You have ",p," attempts left",(0,l.jsx)("br",{})]}),(0,l.jsx)(r.eW,{className:"flex justify-center",children:"If the first move is not played, please refresh the page"})]})})]})})]})}}},function(e){e.O(0,[106,37,364,866,149,810,103,173,942,5,154,695,410,971,23,744],function(){return e(e.s=7772)}),_N_E=e.O()}]);